import string
import ast
from unittest import result
import pymysql
import json


class MysqlTools:

    def __init__(self) -> None:
        self.__myHost = '101.43.47.172'
        self.__myPort = 3306
        self.__userName = 'root'
        self.__pwd = '0920'
        self.__database = 'whpu'
        self.__charset = 'utf8'
        pass


    def getCargoOld(self, typeCount): 
        """
        查询立库中陈品的数量，并按照类型统计数量
        """
        db = pymysql.connect(host=self.__myHost, port=self.__myPort, user=self.__userName, password=self.__pwd, database=self.__database, charset=self.__charset)
        cursor = db.cursor()

        sql = "SELECT type, count(*) FROM `goods_locations_info` WHERE s1=1 and s2=1 and sign=(select max(sign) from `goods_locations_info`) GROUP BY type"
        cursor.execute(sql)
        fetchall = cursor.fetchall()
        db.close()

        result = [0] * (typeCount + 1)
        for item in fetchall:
            result[item[0]] = item[1]
        
        return result


    def getCargoNew(self, typeCount):  
        """
        查询立库中新品的数量，并按照类型统计数量
        """
        db = pymysql.connect(host=self.__myHost, port=self.__myPort, user=self.__userName, password=self.__pwd, database=self.__database, charset=self.__charset)
        cursor = db.cursor()
        
        sql = "SELECT type, count(*) FROM `goods_locations_info` WHERE s1=0 and s2=1 and sign=(select max(sign) from `goods_locations_info`) GROUP BY type"
        cursor.execute(sql)
        fetchall = cursor.fetchall()
        db.close()

        result = [0] * (typeCount + 1)
        for item in fetchall:
            result[item[0]] = item[1]
        
        return result
        
        
    def getCargoEmpty(self):  
        """
        查询立库中空货位的数量
        """
        db = pymysql.connect(host=self.__myHost, port=self.__myPort, user=self.__userName, password=self.__pwd, database=self.__database, charset=self.__charset)
        cursor = db.cursor()

        sql = "SELECT type, count(*) FROM `goods_locations_info` WHERE s1=0 and s2=0 and sign=(select max(sign) from `goods_locations_info`) GROUP BY type"
        cursor.execute(sql)
        fetchall = cursor.fetchall()
        db.close()
        
        result = {}
        for item in fetchall:
            result[item[0]] = item[1]
        
        return result

    
    def getWarehouseNew(self, typeCount):
        result = [0]
        result.extend([999] * (typeCount))

        return result

    
    def getWarehouseOld(self, typeCount):
        # FIXME 假设了平库里面都是满的（因为没有数据）
        result = [0]
        result.extend([99] * (typeCount))

        return result

    
    def getWarehouseEmpty(self):
        result = {100: 9999999999}

        return result

    
    def getDepositeInfo(self, typeCount):
        depositInfo = [{"14": 0, "10": 122, "12": 0, "13": 0, "11": 500, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 100, "12": 0, "13": 0, "11": 90, "15": 0, "16": 0}, {"14": 0, "10": 210, "12": 0, "13": 0, "11": 686, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 14, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 47, "12": 0, "13": 0, "11": 92, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 52, "12": 0, "13": 0, "11": 115, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 165, "12": 0, "13": 0, "11": 115, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 55, "12": 0, "13": 0, "11": 212, "15": 0, "16": 0}, {"14": 0, "10": 150, "12": 0, "13": 0, "11": 115, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 120, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 155, "12": 0, "13": 0, "11": 112, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 35, "15": 150, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 45, "12": 0, "13": 0, "11": 45, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 22, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}]
        result = [0] * (typeCount + 1)
        for dict in depositInfo:
            for key, value in dict.items():
                result[int(key)] += value
        
        return result

        pass


    def getCheckInfo(self, typeCount):
        checkInfo = [{"14": 0, "10": 0, "12": 58, "13": 72, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 1042, "12": 289, "13": 99, "11": 506, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 83, "10": 1005, "12": 204, "13": 147, "11": 900, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 1041, "12": 302, "13": 152, "11": 484, "15": 350, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 274, "10": 1042, "12": 0, "13": 163, "11": 850, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}, {"14": 0, "10": 0, "12": 0, "13": 0, "11": 0, "15": 0, "16": 0}]
        result = [0] * (typeCount + 1)
        for dict in checkInfo:
            for key, value in dict.items():
                result[int(key)] += value
        
        return result

        pass


    def getArrivalInfo(self, typeCount): 
        arrivalInfo = [
            {
                "14": 0,
                "10": 867,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 200,
                "15": 295,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 800,
                "15": 55,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 833,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 500,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 1380,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 1260,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 750,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            },
            {
                "14": 0,
                "10": 0,
                "12": 0,
                "13": 0,
                "11": 0,
                "15": 0,
                "16": 0
            }
        ]
        result = [0] * (typeCount + 1)
        for dict in arrivalInfo:
            for key, value in dict.items():
                result[int(key)] += value
        
        return result
        pass